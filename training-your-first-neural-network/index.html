<!DOCTYPE html>
<html lang="en">
<head>
          <title>Machine Learning - Karlsruhe</title>
        <meta charset="utf-8" />
        <link href="//ml-ka.de/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="Machine Learning - Karlsruhe Full Atom Feed" />
        <link href="//ml-ka.de/feeds/projekte.atom.xml" type="application/atom+xml" rel="alternate" title="Machine Learning - Karlsruhe Categories Atom Feed" />



    <meta name="tags" content="Deep Learning" />
    <meta name="tags" content="MNIST" />
    <meta name="tags" content="Tensor Flow" />

</head>

<body id="index" class="home">
        <header id="banner" class="body">
                <h1><a href="//ml-ka.de/">Machine Learning - Karlsruhe <strong></strong></a></h1>
        </header><!-- /#banner -->
        <nav id="menu"><ul>
            <li><a href="//ml-ka.de/pages/about/">About</a></li>
        </ul></nav><!-- /#menu -->
<section id="content" class="body">
  <header>
    <h2 class="entry-title">
      <a href="//ml-ka.de/training-your-first-neural-network/" rel="bookmark"
         title="Permalink to Training your first Neural Network">Training your first Neural Network</a></h2>
 
  </header>
  <footer class="post-info">
    <abbr class="published" title="2015-12-02T21:10:00+01:00">
      Mi 02 Dezember 2015
    </abbr>
    <address class="vcard author">
      By           <a class="url fn" href="//ml-ka.de/author/martin-thoma.html">Martin Thoma</a>
    </address>
  </footer><!-- /.post-info -->
  <div class="entry-content">
    <p>The following article gives you the necessary knowledge to train and evaluate a
neural network to solve the MNIST task on Kaggle. You will get three
interesting abilities:</p>
<ol>
<li>Working with Tensor Flow</li>
<li>Working with medium-sized datasets</li>
<li>Using Kaggle</li>
</ol>
<p>Additionally, you will get some knowledge about Python. Python is the language
of my choice when it comes to quickly trying some ideas.</p>
<h2>What is MNIST?</h2>
<figure style="display:table;float:right">
<img style="float:right;" align="middle"  width="256px" src="//ml-ka.de/images/mnist-2.png">
<figcaption style="display:table-caption;caption-side:bottom">One example of an item in the MNIST dataset - the digit 2</figcaption>
</figure>

<p>MNIST is a dataset of 28px&nbsp;Ã—&nbsp;28px digits. The training set contains
60,000 examples and the test set contains 10,000 examples. If you want to know
more, you can read the <a href="http://yann.lecun.com/exdb/mnist/">official Website</a>.</p>
<h2>The Framework: Tensor Flow</h2>
<p>Tensor Flow is a framework which allows you to train neural networks with GPU,
but also with CPU. I've wrote a couple of words in a blog post:
<a href="http://martin-thoma.com/tensor-flow-quick/">Tensor Flow - A quick impression</a></p>
<h3>Using GPU at ATIS</h3>
<p>KIT students have the possibility to use the ATIS computer pool. They have
some computer at the very end of the room which have GPUs (i08pc50 - i08pc72;
GeForce GTX 560 Ti 448 Cores).</p>
<p>Recently, CUDA 7.5 was installed on the Fedora systems, but you still have
to add the following lines to your <code>~/.bashrc</code> file:</p>
<div class="highlight"><pre><span></span>export PATH=$PATH:&quot;/opt/cuda-7.5/bin&quot;
export LD_LIBRARY_PATH=$LD_LIBRARY_PATH:&quot;/opt/cuda-7.5/lib64&quot;
</pre></div>


<p>Make sure it appears when you execute <code>echo $PATH</code> and <code>echo LD_LIBRARY_PATH</code>.
If it doesn't, execute <code>source ~/.bashrc</code>. Depending on your configuration,
you might have to do this every time when you start a new console session.</p>
<p>UPDATE: I've tried it very quickly and it seems not to work out of the box in
ATIS. However, you can sill use your personal computer.</p>
<p>The error I get is</p>
<div class="highlight"><pre><span></span>Traceback <span class="o">(</span>most recent call last<span class="o">)</span>:
  File <span class="s2">&quot;tftest.py&quot;</span>, line 4, in &lt;module&gt;
    import tensorflow as tf
  File <span class="s2">&quot;/home/stud/s_thoma/.local/lib/python2.7/site-packages/tensorflow/__init__.py&quot;</span>, line 4, in &lt;module&gt;
    from tensorflow.python import *
  File <span class="s2">&quot;/home/stud/s_thoma/.local/lib/python2.7/site-packages/tensorflow/python/__init__.py&quot;</span>, line 22, in &lt;module&gt;
    from tensorflow.python.client.client_lib import *
  File <span class="s2">&quot;/home/stud/s_thoma/.local/lib/python2.7/site-packages/tensorflow/python/client/client_lib.py&quot;</span>, line 35, in &lt;module&gt;
    from tensorflow.python.client.session import InteractiveSession
  File <span class="s2">&quot;/home/stud/s_thoma/.local/lib/python2.7/site-packages/tensorflow/python/client/session.py&quot;</span>, line 11, in &lt;module&gt;
    from tensorflow.python import pywrap_tensorflow as tf_session
  File <span class="s2">&quot;/home/stud/s_thoma/.local/lib/python2.7/site-packages/tensorflow/python/pywrap_tensorflow.py&quot;</span>, line 28, in &lt;module&gt;
    <span class="nv">_pywrap_tensorflow</span> <span class="o">=</span> swig_import_helper<span class="o">()</span>
  File <span class="s2">&quot;/home/stud/s_thoma/.local/lib/python2.7/site-packages/tensorflow/python/pywrap_tensorflow.py&quot;</span>, line 24, in swig_import_helper
    <span class="nv">_mod</span> <span class="o">=</span> imp.load_module<span class="o">(</span><span class="s1">&#39;_pywrap_tensorflow&#39;</span>, fp, pathname, description<span class="o">)</span>
ImportError: libcudart.so.7.0: cannot open shared object file: No such file or directory
</pre></div>


<h2>What is Kaggle?</h2>
<p>Kaggle is a Machine Learning competition website. It describes tasks in a very
simple way, provides the data and lets you instantly compare yourself (or
rather your results) with others. With this article, you should be able to make
a decent submission for the
<a href="https://www.kaggle.com/c/digit-recognizer">Digit Recognizer</a> task.</p>
<h2>What to do</h2>
<ol>
<li>Get a Python installation and get a feeling how Python works. If you didn't
   use Python before, I suggest reading chapters 1-5 of the
   <a href="https://docs.python.org/2/tutorial/">official Python 2 tutorial</a>.</li>
<li><a href="http://www.tensorflow.org/get_started/os_setup.html">Install Tensor Flow</a></li>
<li>Make sure Tensor Flow works</li>
<li>Read the <a href="http://www.tensorflow.org/tutorials/mnist/beginners/index.html">MNIST For ML Beginners</a> tutorial</li>
<li>Register at Kaggle, download the data for the
   <a href="https://www.kaggle.com/c/digit-recognizer">Digit Recognizer task</a>, adjust
   your implementation from step&nbsp;5 and make a submission to Kaggle.</li>
</ol>
<h2>Questions</h2>
<h3>How do I get Python?</h3>
<p>I have to admit that I always worked on systems which already had a running
Python installation. This is one reason why I really like working with
Ubuntu (Linux). You only have to execute <code>sudo apt-get install python-pip</code> and
you're ready to go.</p>
<p>The official page is <a href="https://www.python.org/downloads/">www.python.org/downloads</a>.
If you're having trouble getting a working Python installation, don't hesitate
to ask for help.</p>
<h3>How do I check if my Python installation is working?</h3>
<p>Go to the command line and execute <code>python --version</code>. My output is <code>Python 2.7.6</code>.
As long as you get something like <code>Python 2.7.X</code> it is ok. Tensor Flow works
only with Python&nbsp;2, not with Python&nbsp;3.</p>
<p>Then execute <code>pip --version</code>. It should output something like</p>
<div class="highlight"><pre><span></span>$ pip --version
pip 6.0.6 from /usr/local/lib/python2.7/dist-packages/pip-6.0.6-py2.7.egg <span class="o">(</span>python 2.7<span class="o">)</span>
</pre></div>


<p>pip is a package manager for Python. You might need it to install several
packages, including Tensor Flow.</p>
<h3>How do I make sure Tensor Flow works?</h3>
<p>Create a <code>testtf.py</code> with the following content:</p>
<div class="highlight"><pre><span></span><span class="ch">#!/usr/bin/env python</span>

<span class="kn">import</span> <span class="nn">tensorflow</span> <span class="kn">as</span> <span class="nn">tf</span>
<span class="n">hello</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">constant</span><span class="p">(</span><span class="s1">&#39;Hello, TensorFlow!&#39;</span><span class="p">)</span>
<span class="n">sess</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">Session</span><span class="p">()</span>
<span class="k">print</span><span class="p">(</span><span class="n">sess</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">hello</span><span class="p">))</span>

<span class="n">a</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">constant</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">constant</span><span class="p">(</span><span class="mi">32</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">sess</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">a</span> <span class="o">+</span> <span class="n">b</span><span class="p">))</span>
</pre></div>


<p>Execute it with the command <code>python testtf.py</code>. For me, the output is</p>
<div class="highlight"><pre><span></span>I tensorflow/core/common_runtime/local_device.cc:25] Local device intra op parallelism threads: 12
I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:888] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
I tensorflow/core/common_runtime/gpu/gpu_init.cc:88] Found device 0 with properties: 
name: GeForce GTX TITAN Black
major: 3 minor: 5 memoryClockRate (GHz) 0.98
pciBusID 0000:01:00.0
Total memory: 6.00GiB
Free memory: 5.77GiB
I tensorflow/core/common_runtime/gpu/gpu_init.cc:112] DMA: 0 
I tensorflow/core/common_runtime/gpu/gpu_init.cc:122] 0:   Y 
I tensorflow/core/common_runtime/gpu/gpu_device.cc:643] Creating TensorFlow device (/gpu:0) -&gt; (device: 0, name: GeForce GTX TITAN Black, pci bus id: 0000:01:00.0)
I tensorflow/core/common_runtime/gpu/gpu_region_allocator.cc:47] Setting region size to 5884919808
I tensorflow/core/common_runtime/local_session.cc:45] Local session inter op parallelism threads: 12
Hello, TensorFlow!
42
</pre></div>


<p>The important part is</p>
<div class="highlight"><pre><span></span>Hello, TensorFlow!
42
</pre></div>


<p>if you don't get that, there is something wrong.</p>
  </div><!-- /.entry-content -->
</section>
        <footer id="contentinfo" class="body">
                <address id="about" class="vcard body">
                Proudly powered by <a href="http://getpelican.com/">Pelican</a>,
                which takes great advantage of <a href="http://python.org">Python</a>.
                </address><!-- /#about -->
        </footer><!-- /#contentinfo -->
</body>
</html>